var e=Object.defineProperty,n=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,t=(n,l,o)=>l in n?e(n,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[l]=o;import{d as u,r as a,a as r,i as s,w as i,c,b as d,e as p,v,f as m,g as b,t as g,h as f,o as w,j as k,k as y,l as L,L as h,m as U}from"./vendor.45d8dce4.js";!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(l){const o=new URL(e,location),t=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((l,u)=>{const a=new URL(e,o);if(self[n].moduleMap[a])return l(self[n].moduleMap[a]);const r=new Blob([`import * as m from '${a}';`,`${n}.moduleMap['${a}']=m;`],{type:"text/javascript"}),s=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){u(new Error(`Failed to import: ${e}`)),t(s)},onload(){l(self[n].moduleMap[a]),t(s)}});document.head.appendChild(s)})),self[n].moduleMap={}}}("/login-client-vue/assets/");const C=u({name:"App",setup(){const e=a("localhost:3004"),n=a(!1),l=a(""),o=r(s("login"));return o.connect(e.value,{ssl:n.value}),i((()=>o.user),(e=>{l.value=e&&e.name||""})),{url:e,ssl:n,name:l,login:o,version:"0.0.2",commit:"bef9e6e",branch:"main"}}}),O=d("h1",null," login-client-vue ",-1),j=d("b",null,"Connection:",-1),x=d("br",null,null,-1),R=d("br",null,null,-1),T=d("label",{for:"sslCheckbox"},"SSL",-1),S=d("br",null,null,-1),I=d("b",null,"Status:",-1),M=d("br",null,null,-1),E=d("br",null,null,-1),N=d("br",null,null,-1),P=d("br",null,null,-1),W=d("br",null,null,-1),$={key:0},_=d("br",null,null,-1),V=d("br",null,null,-1),F={key:1},A=d("br",null,null,-1),B={key:2},D=d("hr",null,null,-1);C.render=function(e,n,l,o,t,u){const a=k("user-status");return w(),c("main",null,[O,d("section",null,[d("p",null,[j,x,p(d("input",{"onUpdate:modelValue":n[1]||(n[1]=n=>e.url=n),type:"text",placeholder:"Login Server URL (without protocol)"},null,512),[[v,e.url]]),R,p(d("input",{id:"sslCheckbox","onUpdate:modelValue":n[2]||(n[2]=n=>e.ssl=n),type:"checkbox"},null,512),[[m,e.ssl]]),T,S,d("button",{onClick:n[3]||(n[3]=n=>e.login.connect(e.url,{ssl:e.ssl}))}," Connect ")]),d("p",null,[I,M,b(" Connected: "+g(e.login.connected),1),E,b(" Logged in: "+g(e.login.loggedIn),1),N,b(" User: "+g(e.login.user&&e.login.user.name),1),P,b(" Token: "+g(e.login.token?"✅":"❌"),1),W,e.login.loggedIn?(w(),c("span",$,[p(d("input",{"onUpdate:modelValue":n[4]||(n[4]=n=>e.name=n),type:"text",placeholder:"Name"},null,512),[[v,e.name]]),d("button",{onClick:n[5]||(n[5]=n=>e.login.setName(e.name))}," Set name "),_,d("button",{onClick:n[6]||(n[6]=n=>e.login.openLogoutWindow())}," Logout "),V])):(w(),c("span",F,[d("button",{onClick:n[7]||(n[7]=n=>e.login.openLoginWindow())}," Login "),A])),e.login.connected?(w(),c("span",B,[d("button",{onClick:n[8]||(n[8]=n=>e.login.disconnect())}," Disconnect ")])):f("",!0)])]),d(a),D,d("footer",null," login-client-vue version "+g(e.version)+" ("+g(e.branch)+" - "+g(e.commit)+") ",1)])};const q=u({name:"UserStatus",setup(){const e=s("login");return{login:r(e)}}});q.render=function(e,n,l,o,t,u){return w(),c("a",null,g(e.login.user?e.login.user.name:"login"),1)},q.install=e=>{e.component(q.name,q)};const z=a(!1),G=y(z),H=a(null),J=y(H),K=L((()=>null!==J.value)),Q=a(null),X=y(Q),Y=a([]),Z=y(Y),ee=a(null),ne=y(ee),le=a(null),oe=y(le);let te;const ue=h.events,ae=h.errors;function re(e,n={}){Q.value&&Q.value.connected&&Q.value.disconnect(),Q.value=new h(e,n),Q.value.connect(),Q.value.addEventListener(null,(e=>{var n;switch(n=e.type,se.window&&se.eventType==n&&setTimeout((()=>{se.window&&se.window.close(),se.window=null}),100),e.type){case ue.connect:z.value=!0;break;case ue.disconnect:z.value=!1;break;case ue.login:H.value=e.user;break;case ue.logout:H.value=null,le.value=null;break;case ue.update:H.value=e.user;break;case ue.providers:Y.value=e.providers;break;case ue.about:ee.value=e;break;case ue.token:le.value=e.token,clearTimeout(te),te=setTimeout((()=>{le.value=null}),1e3*e.expiresIn)}}))}const se={window:null,eventType:null};const ie={connected:G,user:J,loggedIn:K,connect:re,disconnect:function(){Q.value&&Q.value.connected&&Q.value.disconnect()},client:X,providers:Z,about:ne,token:oe,events:ue,errors:ae,setName:function(e){X.value&&X.value.setName(e)},openLoginWindow:function(e){if(!X.value||!X.value.connected)return;const n=Z.value.find((({id:n})=>e===n)),l=n&&n.loginURL||ne.value&&ne.value.baseUrl+"login/";l&&(se.window=window.open(l),se.eventType=ue.login)},openLogoutWindow:function(){if(!X.value||!X.value.connected)return;const e=ne.value&&ne.value.baseUrl+"logout/";e&&(se.window=window.open(e),se.eventType=ue.logout)}};var ce=((e,u)=>{for(var a in u||(u={}))n.call(u,a)&&t(e,a,u[a]);if(l)for(var a of l(u))o.call(u,a)&&t(e,a,u[a]);return e})({install:(e,t={})=>{var{url:u}=t,a=((e,t)=>{var u={};for(var a in e)n.call(e,a)&&t.indexOf(a)<0&&(u[a]=e[a]);if(null!=e&&l)for(var a of l(e))t.indexOf(a)<0&&o.call(e,a)&&(u[a]=e[a]);return u})(t,["url"]);u&&re(u,a),e.provide("login",ie),e.use(q)}},ie);U(C).use(ce).mount("#app");
