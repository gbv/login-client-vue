var e=Object.defineProperty,n=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,t=(n,l,o)=>l in n?e(n,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[l]=o;import{d as r,r as a,a as i,i as s,w as u,c,b as d,e as g,v as p,f as v,g as b,t as w,h as m,F as f,j as h,o as k,k as y,l as L,L as U,m as C,n as S,p as E,q as I,s as O,u as R}from"./vendor.372d3cc2.js";!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(l){const o=new URL(e,location),t=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((l,r)=>{const a=new URL(e,o);if(self[n].moduleMap[a])return l(self[n].moduleMap[a]);const i=new Blob([`import * as m from '${a}';`,`${n}.moduleMap['${a}']=m;`],{type:"text/javascript"}),s=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){r(new Error(`Failed to import: ${e}`)),t(s)},onload(){l(self[n].moduleMap[a]),t(s)}});document.head.appendChild(s)})),self[n].moduleMap={}}}("/login-client-vue/assets/");const T="coli-conc.gbv.de/login/",_=!0,j=r({name:"App",setup(){const e=new URLSearchParams(window.location.search),n=a(e.get("server")||T),l=a(e.has("ssl")?"true"===e.get("ssl"):_),o=a(""),t=i(s("login"));return t.connect(n.value,{ssl:l.value}),u((()=>t.user),(e=>{o.value=e&&e.name||""})),{url:n,ssl:l,name:o,login:t,version:"0.1.0",commit:"ce11333",branch:"main",connect(){t.connect(n.value,{ssl:l.value});const e=new URLSearchParams(window.location.search);e.set("server",n.value),e.set("ssl",l.value),window.history.replaceState({},"",`${window.location.href.replace(window.location.search,"")}?${e.toString()}`)}}}}),P=d("div",{style:{clear:"both"}},null,-1),W=d("h1",null," login-client-vue ",-1),$=d("b",null,"Connection:",-1),x=d("br",null,null,-1),B=d("br",null,null,-1),M=d("label",{for:"sslCheckbox"},"SSL",-1),N=d("br",null,null,-1),F=d("b",null,"Status:",-1),V=d("br",null,null,-1),D=d("br",null,null,-1),q=d("br",null,null,-1),A=d("br",null,null,-1),G=d("br",null,null,-1),H={key:0},z=d("br",null,null,-1),J=d("br",null,null,-1),K={key:1},Q=d("br",null,null,-1),X={key:2},Y=d("hr",null,null,-1),Z=d("br",null,null,-1),ee=d("a",{href:"https://github.com/gbv/login-client-vue"}," Documentation on GitHub ",-1);j.render=function(e,n,l,o,t,r){const a=h("user-status");return k(),c(f,null,[d("nav",null,[d(a,{style:{float:"right"}}),P]),d("main",null,[W,d("section",null,[d("p",null,[$,x,g(d("input",{"onUpdate:modelValue":n[1]||(n[1]=n=>e.url=n),type:"text",placeholder:"Login Server URL (without protocol)"},null,512),[[p,e.url]]),B,g(d("input",{id:"sslCheckbox","onUpdate:modelValue":n[2]||(n[2]=n=>e.ssl=n),type:"checkbox"},null,512),[[v,e.ssl]]),M,N,d("button",{onClick:n[3]||(n[3]=(...n)=>e.connect&&e.connect(...n))}," Connect ")]),d("p",null,[F,V,b(" Connected: "+w(e.login.connected),1),D,b(" Logged in: "+w(e.login.loggedIn),1),q,b(" User: "+w(e.login.user&&e.login.user.name),1),A,b(" Token: "+w(e.login.token?"✅":"❌"),1),G,e.login.loggedIn?(k(),c("span",H,[g(d("input",{"onUpdate:modelValue":n[4]||(n[4]=n=>e.name=n),type:"text",placeholder:"Name"},null,512),[[p,e.name]]),d("button",{onClick:n[5]||(n[5]=n=>e.login.setName(e.name))}," Set name "),z,d("button",{onClick:n[6]||(n[6]=n=>e.login.openLogoutWindow())}," Logout "),J])):(k(),c("span",K,[d("button",{onClick:n[7]||(n[7]=n=>e.login.openLoginWindow())}," Login "),Q])),e.login.connected?(k(),c("span",X,[d("button",{onClick:n[8]||(n[8]=n=>e.login.disconnect())}," Disconnect ")])):m("",!0)])]),Y,d("footer",null,[b(" login-client-vue v"+w(e.version)+" ("+w(e.branch)+" - "+w(e.commit)+")",1),Z,ee])])],64)};const ne=a(!1),le=y(ne),oe=a(null),te=y(oe),re=L((()=>null!==te.value)),ae=a(null),ie=y(ae),se=a([]),ue=y(se),ce=a(null),de=y(ce),ge=a(null),pe=y(ge);let ve;const be=a(null),we=y(be),me=U.events,fe=U.errors;function he(e,n={}){ae.value&&ae.value.disconnect(),ae.value=new U(e,n),ae.value.connect(),ae.value.addEventListener(null,(e=>{var n;switch(n=e.type,ke.window&&ke.eventType==n&&setTimeout((()=>{ke.window&&ke.window.close(),ke.window=null}),100),e.type){case me.connect:ne.value=!0;break;case me.disconnect:ne.value=!1;break;case me.login:oe.value=e.user;break;case me.logout:oe.value=null,ge.value=null;break;case me.update:oe.value=e.user;break;case me.providers:se.value=e.providers;break;case me.about:ce.value=e;break;case me.token:ge.value=e.token,clearTimeout(ve),ve=setTimeout((()=>{ge.value=null}),1e3*e.expiresIn);break;case me.error:be.value=e.error}}))}const ke={window:null,eventType:null};const ye={connected:le,user:te,loggedIn:re,connect:he,disconnect:function(){ae.value&&ae.value.connected&&ae.value.disconnect()},client:ie,providers:ue,about:de,token:pe,events:me,errors:fe,setName:function(e){ie.value&&ie.value.setName(e)},openLoginWindow:function({id:e,redirect:n=!1}={}){if(!ie.value||!ie.value.connected)return;const l=ie.value._about,o=ue.value.find((({id:n})=>e===n)),t=o&&o.loginURL||l&&l.baseUrl+"login/";t&&(n?window.location.href=`${t}?redirect_uri=${encodeURIComponent(window.location.href)}`:(ke.window=window.open(t),ke.eventType=me.login))},openLogoutWindow:function({redirect:e=!1}={}){if(!ie.value||!ie.value.connected)return;const n=ie.value._about,l=n&&n.baseUrl+"logout/";l&&(e?window.location.href=`${l}?redirect_uri=${encodeURIComponent(window.location.href)}`:(ke.window=window.open(l),ke.eventType=me.logout))},openBaseWindow:function(){if(!ie.value)return;const e=ie.value._about,n=e&&e.baseUrl;n&&window.open(n)},lastError:we};var Le=((e,r)=>{for(var a in r||(r={}))n.call(r,a)&&t(e,a,r[a]);if(l)for(var a of l(r))o.call(r,a)&&t(e,a,r[a]);return e})({install:(e,t={})=>{var{url:r}=t,a=((e,t)=>{var r={};for(var a in e)n.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&l)for(var a of l(e))t.indexOf(a)<0&&o.call(e,a)&&(r[a]=e[a]);return r})(t,["url"]);r&&he(r,a),e.provide("login",ye)}},ye);const Ue=r({name:"UserStatus",props:{redirect:{type:Boolean,default:!1}},setup:()=>({login:i(Le)})}),Ce=E();I("data-v-6e489b81");const Se={class:"user-status"},Ee=d("span",{class:"carret-down"},"▼",-1),Ie={class:"user-status-dropdown"},Oe={key:0},Re=b(" Error: "),Te=b(" Please check your internet connection. "),_e=b(" Third-party cookies are blocked in your browser which means that a connection to the server can't be established. "),je=b(" There seems to be an issue with the server. Please try again later. "),Pe=b(" Unknown error. Please try again later. "),We=d("hr",null,null,-1),$e=d("p",null," Sign in via ",-1),xe=d("hr",null,null,-1),Be={style:{"overflow-wrap":"break-word"}},Me=b(" Open Login Server "),Ne={style:{"font-weight":"normal"}},Fe=d("br",null,null,-1);O();const Ve=Ce(((e,n,l,o,t,r)=>(k(),c("div",Se,[d("a",{href:"",class:{"user-status-disconnected":!e.login.connected},onClick:n[1]||(n[1]=C((n=>e.login.connected&&(e.login.loggedIn?e.login.openBaseWindow():e.login.openLoginWindow({redirect:e.redirect}))),["prevent"]))},[b(w(e.login.loggedIn?e.login.user.name:"Sign in")+" ",1),Ee],2),d("div",Ie,[e.login.connected?e.login.loggedIn?(k(),c(f,{key:1},[d("p",null," Signed in as "+w(e.login.user.name)+". ",1),We,d("ul",null,[d("li",null,[d("a",{href:"",onClick:n[2]||(n[2]=C((n=>e.login.openLogoutWindow()),["prevent"]))}," Sign out ")])])],64)):(k(),c(f,{key:2},[$e,d("ul",null,[(k(!0),c(f,null,S(e.login.providers,(n=>(k(),c("li",{key:n.id},[d("a",{href:"",onClick:C((l=>e.login.openLoginWindow({id:n.id,redirect:e.redirect})),["prevent"])},[n.image?(k(),c("img",{key:0,src:n.image},null,8,["src"])):m("",!0),b(" "+w(n.name),1)],8,["onClick"])])))),128))])],64)):(k(),c("p",Oe,[Re,e.login.lastError instanceof e.login.errors.NoInternetConnectionError?(k(),c(f,{key:0},[Te],64)):e.login.lastError instanceof e.login.errors.ThirdPartyCookiesBlockedError?(k(),c(f,{key:1},[_e],64)):e.login.lastError instanceof e.login.errors.ServerConnectionError?(k(),c(f,{key:2},[je],64)):(k(),c(f,{key:3},[Pe],64))])),e.login.client&&e.login.client.about&&e.login.client.about.baseUrl?(k(),c(f,{key:3},[xe,d("ul",null,[d("li",Be,[d("a",{href:"",onClick:n[3]||(n[3]=C((n=>e.login.openBaseWindow()),["prevent"]))},[Me,d("small",Ne,[Fe,b("at "+w(e.login.client.about.baseUrl),1)])])])])],64)):m("",!0)])]))));Ue.render=Ve,Ue.__scopeId="data-v-6e489b81",Ue.install=e=>{e.component(Ue.name,Ue)},R(j).use(Le).use(Ue).mount("#app");
