var e=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable;import{d as l,r as t,w as r,c as a,a as i,b as s,v as u,e as c,f as d,t as g,g as p,F as v,i as w,h as b,o as m,j as f,k as h,L as k,l as y,m as L,n as U,p as C,q as S,s as E,u as I}from"./vendor.0e9e6eb9.js";!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(o){const l=new URL(e,location),t=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((o,r)=>{const a=new URL(e,l);if(self[n].moduleMap[a])return o(self[n].moduleMap[a]);const i=new Blob([`import * as m from '${a}';`,`${n}.moduleMap['${a}']=m;`],{type:"text/javascript"}),s=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){r(new Error(`Failed to import: ${e}`)),t(s)},onload(){o(self[n].moduleMap[a]),t(s)}});document.head.appendChild(s)})),self[n].moduleMap={}}}("/login-client-vue/assets/");const R="coli-conc.gbv.de/login/",O=!0,T=l({name:"App",setup(){const e=new URLSearchParams(window.location.search),n=t(e.get("server")||R),o=t(e.has("ssl")?"true"===e.get("ssl"):O),l=t(""),a=w("login");return a.connect(n.value,{ssl:o.value}),r((()=>a.user),(e=>{l.value=e&&e.name||""})),{url:n,ssl:o,name:l,login:a,version:"0.2.1",commit:"e90a07d",branch:"main",connect(){a.connect(n.value,{ssl:o.value});const e=new URLSearchParams(window.location.search);e.set("server",n.value),e.set("ssl",o.value),window.history.replaceState({},"",`${window.location.href.replace(window.location.search,"")}?${e.toString()}`)}}}}),_=i("div",{style:{clear:"both"}},null,-1),W=i("h1",null," login-client-vue ",-1),$=i("b",null,"Connection:",-1),j=i("br",null,null,-1),x=i("br",null,null,-1),P=i("label",{for:"sslCheckbox"},"SSL",-1),B=i("br",null,null,-1),M=i("b",null,"Status:",-1),N=i("br",null,null,-1),F=i("br",null,null,-1),V=i("br",null,null,-1),D=i("br",null,null,-1),q=i("br",null,null,-1),A={key:0},G=i("br",null,null,-1),H=i("br",null,null,-1),z={key:1},J=i("br",null,null,-1),K={key:2},Q=i("hr",null,null,-1),X=i("br",null,null,-1),Y=i("a",{href:"https://github.com/gbv/login-client-vue"}," Documentation on GitHub ",-1);T.render=function(e,n,o,l,t,r){const w=b("user-status");return m(),a(v,null,[i("nav",null,[i(w,{style:{float:"right"}}),_]),i("main",null,[W,i("section",null,[i("p",null,[$,j,s(i("input",{"onUpdate:modelValue":n[1]||(n[1]=n=>e.url=n),type:"text",placeholder:"Login Server URL (without protocol)"},null,512),[[u,e.url]]),x,s(i("input",{id:"sslCheckbox","onUpdate:modelValue":n[2]||(n[2]=n=>e.ssl=n),type:"checkbox"},null,512),[[c,e.ssl]]),P,B,i("button",{onClick:n[3]||(n[3]=(...n)=>e.connect&&e.connect(...n))}," Connect ")]),i("p",null,[M,N,d(" Connected: "+g(e.login.connected),1),F,d(" Logged in: "+g(e.login.loggedIn),1),V,d(" User: "+g(e.login.user&&e.login.user.name),1),D,d(" Token: "+g(e.login.token?"✅":"❌"),1),q,e.login.loggedIn?(m(),a("span",A,[s(i("input",{"onUpdate:modelValue":n[4]||(n[4]=n=>e.name=n),type:"text",placeholder:"Name"},null,512),[[u,e.name]]),i("button",{onClick:n[5]||(n[5]=n=>e.login.setName(e.name))}," Set name "),G,i("button",{onClick:n[6]||(n[6]=n=>e.login.openLogoutWindow())}," Logout "),H])):(m(),a("span",z,[i("button",{onClick:n[7]||(n[7]=n=>e.login.openLoginWindow())}," Login "),J])),e.login.connected?(m(),a("span",K,[i("button",{onClick:n[8]||(n[8]=n=>e.login.disconnect())}," Disconnect ")])):p("",!0)])]),Q,i("footer",null,[d(" login-client-vue v"+g(e.version)+" ("+g(e.branch)+" - "+g(e.commit)+")",1),X,Y])])],64)};const Z=t(!1),ee=f(Z),ne=t(null),oe=f(ne),le=h((()=>null!==oe.value)),te=t(null),re=f(te),ae=t([]),ie=f(ae),se=t(null),ue=f(se),ce=t(null),de=f(ce);let ge;const pe=t(null),ve=f(pe),we=k.events,be=k.errors;function me(e,n={}){te.value&&te.value.disconnect(),te.value=new k(e,n),te.value.connect(),te.value.addEventListener(null,(e=>{var n;switch(n=e.type,fe.window&&fe.eventType==n&&setTimeout((()=>{fe.window&&fe.window.close(),fe.window=null}),100),e.type){case we.connect:Z.value=!0;break;case we.disconnect:Z.value=!1;break;case we.login:ne.value=e.user;break;case we.logout:ne.value=null,ce.value=null;break;case we.update:ne.value=e.user;break;case we.providers:ae.value=e.providers;break;case we.about:se.value=e;break;case we.token:ce.value=e.token,clearTimeout(ge),ge=setTimeout((()=>{ce.value=null}),1e3*e.expiresIn);break;case we.error:pe.value=e.error}}))}const fe={window:null,eventType:null};const he={connected:ee,user:oe,loggedIn:le,connect:me,disconnect:function(){te.value&&te.value.connected&&te.value.disconnect()},client:re,providers:ie,about:ue,token:de,events:we,errors:be,setName:function(e){re.value&&re.value.setName(e)},openLoginWindow:function({id:e,redirect:n=!1}={}){if(!re.value||!re.value.connected)return;const o=re.value._about,l=ie.value.find((({id:n})=>e===n)),t=l&&l.loginURL||o&&o.baseUrl+"login/";t&&(n?window.location.href=`${t}?redirect_uri=${encodeURIComponent(window.location.href)}`:(fe.window=window.open(t),fe.eventType=we.login))},openLogoutWindow:function({redirect:e=!1}={}){if(!re.value||!re.value.connected)return;const n=re.value._about,o=n&&n.baseUrl+"logout/";o&&(e?window.location.href=`${o}?redirect_uri=${encodeURIComponent(window.location.href)}`:(fe.window=window.open(o),fe.eventType=we.logout))},openBaseWindow:function(){if(!re.value)return;const e=re.value._about,n=e&&e.baseUrl;n&&window.open(n)},lastError:ve},ke=y(he);ke.install=(l,t={})=>{var{url:r}=t,a=((l,t)=>{var r={};for(var a in l)e.call(l,a)&&t.indexOf(a)<0&&(r[a]=l[a]);if(null!=l&&n)for(var a of n(l))t.indexOf(a)<0&&o.call(l,a)&&(r[a]=l[a]);return r})(t,["url"]);r&&me(r,a),l.provide("login",f(he)),l.provide("login-refs",he)};const ye=l({name:"UserStatus",props:{redirect:{type:Boolean,default:!1}},setup:()=>({login:ke})}),Le=C();S("data-v-5bef7fd6");const Ue={class:"user-status"},Ce=i("span",{class:"carret-down"},"▼",-1),Se={class:"user-status-dropdown"},Ee={key:0},Ie=d(" Error: "),Re=d(" Please check your internet connection. "),Oe=d(" Third-party cookies are blocked in your browser which means that a connection to the server can't be established. "),Te=d(" There seems to be an issue with the server. Please try again later. "),_e=d(" Unknown error. Please try again later. "),We=i("hr",null,null,-1),$e=i("p",null," Sign in via ",-1),je=i("hr",null,null,-1),xe={style:{"overflow-wrap":"break-word"}},Pe=d(" Open Login Server "),Be={style:{"font-weight":"normal"}},Me=i("br",null,null,-1);E();const Ne=Le(((e,n,o,l,t,r)=>(m(),a("div",Ue,[i("a",{href:"",class:{"user-status-disconnected":!e.login.connected},onClick:n[1]||(n[1]=L((n=>e.login.connected&&(e.login.loggedIn?e.login.openBaseWindow():e.login.openLoginWindow({redirect:e.redirect}))),["prevent"]))},[d(g(e.login.loggedIn?e.login.user.name:"Sign in")+" ",1),Ce],2),i("div",Se,[e.login.connected?e.login.loggedIn?(m(),a(v,{key:1},[i("p",null," Signed in as "+g(e.login.user.name)+". ",1),We,i("ul",null,[i("li",null,[i("a",{href:"",onClick:n[2]||(n[2]=L((n=>e.login.openLogoutWindow()),["prevent"]))}," Sign out ")])])],64)):(m(),a(v,{key:2},[$e,i("ul",null,[(m(!0),a(v,null,U(e.login.providers,(n=>(m(),a("li",{key:n.id},[i("a",{href:"",onClick:L((o=>e.login.openLoginWindow({id:n.id,redirect:e.redirect})),["prevent"])},[n.image?(m(),a("img",{key:0,src:n.image},null,8,["src"])):p("",!0),d(" "+g(n.name),1)],8,["onClick"])])))),128))])],64)):(m(),a("p",Ee,[Ie,e.login.lastError instanceof e.login.errors.NoInternetConnectionError?(m(),a(v,{key:0},[Re],64)):e.login.lastError instanceof e.login.errors.ThirdPartyCookiesBlockedError?(m(),a(v,{key:1},[Oe],64)):e.login.lastError instanceof e.login.errors.ServerConnectionError?(m(),a(v,{key:2},[Te],64)):(m(),a(v,{key:3},[_e],64))])),e.login.client&&e.login.client.about&&e.login.client.about.baseUrl?(m(),a(v,{key:3},[je,i("ul",null,[i("li",xe,[i("a",{href:"",onClick:n[3]||(n[3]=L((n=>e.login.openBaseWindow()),["prevent"]))},[Pe,i("small",Be,[Me,d("at "+g(e.login.client.about.baseUrl),1)])])])])],64)):p("",!0)])]))));ye.render=Ne,ye.__scopeId="data-v-5bef7fd6",ye.install=e=>{e.component(ye.name,ye)},I(T).use(ke).use(ye).mount("#app");
