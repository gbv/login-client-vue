var e=Object.defineProperty,n=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,t=(n,l,o)=>l in n?e(n,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[l]=o;import{d as a,r as u,a as r,i,w as s,c,b as d,e as p,v,f as g,g as b,t as m,h as w,F as f,j as k,o as y,k as h,l as L,L as C,m as U,n as S,p as O,q as _,s as j,u as x}from"./vendor.9a4e915f.js";!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(l){const o=new URL(e,location),t=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((l,a)=>{const u=new URL(e,o);if(self[n].moduleMap[u])return l(self[n].moduleMap[u]);const r=new Blob([`import * as m from '${u}';`,`${n}.moduleMap['${u}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){a(new Error(`Failed to import: ${e}`)),t(i)},onload(){l(self[n].moduleMap[u]),t(i)}});document.head.appendChild(i)})),self[n].moduleMap={}}}("/login-client-vue/dev/assets/");const I=a({name:"App",setup(){const e=u("localhost:3004"),n=u(!1),l=u(""),o=r(i("login"));return o.connect(e.value,{ssl:n.value}),s((()=>o.user),(e=>{l.value=e&&e.name||""})),{url:e,ssl:n,name:l,login:o,version:"0.0.2",commit:"2ef435b",branch:"dev"}}}),W=d("div",{style:{clear:"both"}},null,-1),R=d("h1",null," login-client-vue ",-1),T=d("b",null,"Connection:",-1),$=d("br",null,null,-1),E=d("br",null,null,-1),M=d("label",{for:"sslCheckbox"},"SSL",-1),B=d("br",null,null,-1),N=d("b",null,"Status:",-1),P=d("br",null,null,-1),F=d("br",null,null,-1),V=d("br",null,null,-1),q=d("br",null,null,-1),A=d("br",null,null,-1),D={key:0},z=d("br",null,null,-1),G=d("br",null,null,-1),H={key:1},J=d("br",null,null,-1),K={key:2},Q=d("hr",null,null,-1);I.render=function(e,n,l,o,t,a){const u=k("user-status");return y(),c(f,null,[d("nav",null,[d(u,{style:{float:"right"}}),W]),d("main",null,[R,d("section",null,[d("p",null,[T,$,p(d("input",{"onUpdate:modelValue":n[1]||(n[1]=n=>e.url=n),type:"text",placeholder:"Login Server URL (without protocol)"},null,512),[[v,e.url]]),E,p(d("input",{id:"sslCheckbox","onUpdate:modelValue":n[2]||(n[2]=n=>e.ssl=n),type:"checkbox"},null,512),[[g,e.ssl]]),M,B,d("button",{onClick:n[3]||(n[3]=n=>e.login.connect(e.url,{ssl:e.ssl}))}," Connect ")]),d("p",null,[N,P,b(" Connected: "+m(e.login.connected),1),F,b(" Logged in: "+m(e.login.loggedIn),1),V,b(" User: "+m(e.login.user&&e.login.user.name),1),q,b(" Token: "+m(e.login.token?"✅":"❌"),1),A,e.login.loggedIn?(y(),c("span",D,[p(d("input",{"onUpdate:modelValue":n[4]||(n[4]=n=>e.name=n),type:"text",placeholder:"Name"},null,512),[[v,e.name]]),d("button",{onClick:n[5]||(n[5]=n=>e.login.setName(e.name))}," Set name "),z,d("button",{onClick:n[6]||(n[6]=n=>e.login.openLogoutWindow())}," Logout "),G])):(y(),c("span",H,[d("button",{onClick:n[7]||(n[7]=n=>e.login.openLoginWindow())}," Login "),J])),e.login.connected?(y(),c("span",K,[d("button",{onClick:n[8]||(n[8]=n=>e.login.disconnect())}," Disconnect ")])):w("",!0)])]),Q,d("footer",null," login-client-vue version "+m(e.version)+" ("+m(e.branch)+" - "+m(e.commit)+") ",1)])],64)};const X=u(!1),Y=h(X),Z=u(null),ee=h(Z),ne=L((()=>null!==ee.value)),le=u(null),oe=h(le),te=u([]),ae=h(te),ue=u(null),re=h(ue),ie=u(null),se=h(ie);let ce;const de=C.events,pe=C.errors;function ve(e,n={}){le.value&&le.value.disconnect(),le.value=new C(e,n),le.value.connect(),le.value.addEventListener(null,(e=>{var n;switch(n=e.type,ge.window&&ge.eventType==n&&setTimeout((()=>{ge.window&&ge.window.close(),ge.window=null}),100),e.type){case de.connect:X.value=!0;break;case de.disconnect:X.value=!1;break;case de.login:Z.value=e.user;break;case de.logout:Z.value=null,ie.value=null;break;case de.update:Z.value=e.user;break;case de.providers:te.value=e.providers;break;case de.about:ue.value=e;break;case de.token:ie.value=e.token,clearTimeout(ce),ce=setTimeout((()=>{ie.value=null}),1e3*e.expiresIn)}}))}const ge={window:null,eventType:null};const be={connected:Y,user:ee,loggedIn:ne,connect:ve,disconnect:function(){le.value&&le.value.connected&&le.value.disconnect()},client:oe,providers:ae,about:re,token:se,events:de,errors:pe,setName:function(e){oe.value&&oe.value.setName(e)},openLoginWindow:function({id:e,redirect:n=!1}={}){if(!oe.value)return;const l=oe.value._about,o=ae.value.find((({id:n})=>e===n)),t=o&&o.loginURL||l&&l.baseUrl+"login/";t&&(n?window.location.href=`${t}?redirect_uri=${window.location.href}`:(ge.window=window.open(t),ge.eventType=de.login))},openLogoutWindow:function({redirect:e=!1}={}){if(!oe.value||!oe.value.connected)return;const n=oe.value._about,l=n&&n.baseUrl+"logout/";l&&(e?window.location.href=`${l}?redirect_uri=${window.location.href}`:(ge.window=window.open(l),ge.eventType=de.logout))},openBaseWindow:function(){if(!oe.value||!oe.value.connected)return;const e=oe.value._about,n=e&&e.baseUrl;n&&window.open(n)}};var me=((e,a)=>{for(var u in a||(a={}))n.call(a,u)&&t(e,u,a[u]);if(l)for(var u of l(a))o.call(a,u)&&t(e,u,a[u]);return e})({install:(e,t={})=>{var{url:a}=t,u=((e,t)=>{var a={};for(var u in e)n.call(e,u)&&t.indexOf(u)<0&&(a[u]=e[u]);if(null!=e&&l)for(var u of l(e))t.indexOf(u)<0&&o.call(e,u)&&(a[u]=e[u]);return a})(t,["url"]);a&&ve(a,u),e.provide("login",be)}},be);const we=a({name:"UserStatus",props:{redirect:{type:Boolean,default:!1}},setup:()=>({login:r(me)})}),fe=O();_("data-v-ec9cc5b6");const ke={class:"user-status"},ye=d("span",{class:"carret-down"},"▼",-1),he={class:"user-status-dropdown"},Le={key:0},Ce=d("hr",null,null,-1),Ue=d("p",null," Sign in via ",-1);j();const Se=fe(((e,n,l,o,t,a)=>(y(),c("div",ke,[d("a",{href:"",class:{"user-status-disconnected":!e.login.connected},onClick:n[1]||(n[1]=U((n=>e.login.loggedIn?e.login.openBaseWindow():e.login.openLoginWindow({redirect:e.redirect})),["prevent"]))},[b(m(e.login.loggedIn?e.login.user.name:"Sign in")+" ",1),ye],2),d("div",he,[e.login.connected?e.login.loggedIn?(y(),c(f,{key:1},[d("p",null," Signed in as "+m(e.login.user.name)+". ",1),Ce,d("ul",null,[d("li",null,[d("a",{href:"",onClick:n[2]||(n[2]=U((n=>e.login.openLogoutWindow()),["prevent"]))}," Sign out ")])])],64)):(y(),c(f,{key:2},[Ue,d("ul",null,[(y(!0),c(f,null,S(e.login.providers,(n=>(y(),c("li",{key:n.id},[d("a",{href:"",onClick:U((l=>e.login.openLoginWindow({id:n.id,redirect:e.redirect})),["prevent"])},[n.image?(y(),c("img",{key:0,src:n.image},null,8,["src"])):w("",!0),b(" "+m(n.name),1)],8,["onClick"])])))),128))])],64)):(y(),c("p",Le," Error: Could not connect to Login Server. "))])]))));we.render=Se,we.__scopeId="data-v-ec9cc5b6",we.install=e=>{e.component(we.name,we)},x(I).use(me).use(we).mount("#app");
